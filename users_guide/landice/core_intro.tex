\chapter{Governing Equations}
\label{chap:landice-intro}



Advection is performed on a C-grid, with scalar quantities (thickness, temperature, age, etc.) on the Voronoi cell centers and velocities and fluxes centered at Voronoi cell edges.  MPAS-Land Ice uses SI units everywhere, including input and output.  One exception is the ability (but not the requirement) to specify the model time step in years (but which is then converted to seconds internally).

\section{Momentum Balance}

Currently within MPAS-Land Ice, the momentum balance for ice is approximated with the Shallow Ice Approximation (SIA) \citep{Hutter1983}, which is solved explicitly.  In terms of balancing the gravitational body force, the SIA neglects all but the 0th-order, vertical shear-stress gradients.  The preferred numerical approach for implementing the SIA in ice sheet models is not to solve for the velocity directly but to instead formulate a parabolic PDE describing the thickness evolution, with velocities implicit in the formulation.  However, for higher-order treatments of the momentum balance, it is necessary to solve the velocity and thickness evolution steps separately. Therefore, to allow for the eventual incorporation of higher-order velocity solvers in MPAS Land Ice, the current design explicitly calculates velocities from the SIA.

Within a column, at any point in the model domain in map view, the depth-dependent SIA velocity can be solved for as:

\begin{equation}
    \label{sia}
	\vect{u}(z) = -\frac{1}{2} A (\rho g )^n |\nabla s|^{n-1} \nabla s \left[H^{n+1} - (h-z)^{n+1} \right]
\end{equation}
where $\vect{u}(z)$ is the horizontal velocity vector, $A$ is the flow rate factor (primarily a function of ice temperature), $n$ is the Glen flow law exponent (typically taken as 3), $\rho$ is the density of ice, $g$ is acceleration due to gravity, $s$ is the ice surface elevation, $H$ is ice thickness, and $z$ is the vertical coordinate. Velocities are (nonlinearly) proportional to both the ice thickness and the ice surface slope.

Velocities and fluxes are calculated on the midpoint of Voronoi cell edges.  
The normal component of surface slope is calculated on cell edges 
using surface elevation at adjacent cell centers.  
The tangential component of surface slope is calculated on cell edges using 
surface elevation at adjacent vertices.  
The surface elevation at vertices is calculated from the values at adjacent 
cell centers using barycentric interpolation.
Ice thickness on edges is calculated as the average of the 
adjacent cell center values (2nd-order approximation).


\section{Time Integration}

Currently, MPAS Land Ice only supports Forward Euler time integration.


\section{Advection}

Currently, MPAS Land Ice only supports advection of thickness and only using First-Order Upwinding. 
In 1D, first-order upwinding of ice thickness using a Forward Euler time step is described by:

\begin{equation}
    \label{fouw}
 \frac{H_i^{n+1} - H_i^n}{\Delta t} + u \frac{H_i^n - H_{i-1}^n}{\Delta x} = 0 \quad \text{for} \quad u > 0
\end{equation}
\begin{equation}
 \frac{H_i^{n+1} - H_i^n}{\Delta t} + u \frac{H_{i+1}^n - H_i^n}{\Delta x} = 0 \quad \text{for} \quad u < 0
\end{equation}

where ${\Delta x}$ represents the horizontal grid spacing along flow, subscripts designate the spatial dimension, and superscripts designate the time dimension.

(See, e.g. \url{http://en.wikipedia.org/wiki/Upwind\_scheme})

To allow the eventual inclusion of tracer advection, thickness is advected level-by-level, rather than the cheaper operation of advecting the total column thickness.


